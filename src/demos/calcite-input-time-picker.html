<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Calcite Input Time Picker</title>
    <style>
      body {
        margin: 20px;
      }

      .demo-background-light {
        border: 1px solid #202020;
        padding: 1rem;
      }

      .demo-background-dark {
        background: #202020;
        color: white;
        padding: 1rem;
      }

      h1,
      h2,
      h3 {
        margin: 0;
      }
    </style>
    <link rel="stylesheet" href="https://webapps-cdn.esri.com/CDN/fonts/v1.4.1/fonts.css" />
    <link rel="stylesheet" href="../build/calcite.css" />
    <script type="module" src="../build/calcite.esm.js"></script>
    <script nomodule src="../build/calcite.js"></script>
    <script type="module" src="./_assets/demo-form.js"></script>
    <script type="module" src="./_assets/demo-spacer.js"></script>
    <script>
      class DemoShadow extends HTMLElement {
        constructor() {
          super();
          this.attachShadow({ mode: "open" });
          this.shadowRoot.innerHTML = `
          <calcite-label>
            Time picking in a shadowed component ðŸ•”
            <calcite-input-time-picker scale="s" value="1:2:3" step="1" />
          </calcite-label>
        `;
        }
      }
      customElements.define("demo-shadow", DemoShadow);
    </script>
  </head>

  <body>
    <demo-spacer>
      <calcite-button href="/"> < Home</calcite-button>
      <h1>Calcite Input Time Picker</h1>
    </demo-spacer>

    <div class="demo-background-light">
      <demo-form>
        <form style="display: flex; flex-direction: column; gap: 20px">
          <input id="change-input-time-picker" placeholder="change input-time-picker's value" />
          <calcite-input-time-picker
            id="value-test"
            name="value-test"
            step="1"
            value="14:59"
          ></calcite-input-time-picker>
          <calcite-label>
            Uses preventDefault on calciteInputTimePickerChange Event to prevent entering a null value
            <calcite-input-time-picker id="prevent-default" name="prevent-default-on-null" step="1" value="14:59">
            </calcite-input-time-picker>
          </calcite-label>
          <button id="setFocus" type="button">Calls Set Focus</button>
          <button>Submit</button>
        </form>
      </demo-form>
    </div>

    <demo-spacer>
      <demo-form>
        <form name="calcite-time-demo-form">
          <demo-spacer>
            <div class="demo-background-light">
              <demo-spacer>
                <demo-shadow></demo-shadow>
                <div>
                  <calcite-label for="s" scale="s">Small</calcite-label>
                  <calcite-input-date-picker scale="s" name="s-date"></calcite-input-date-picker>
                  <calcite-input-time-picker id="s" scale="s" name="s" value="1:2"></calcite-input-time-picker>
                </div>
                <div>
                  <calcite-label for="s-second" scale="s">Small with seconds</calcite-label>
                  <calcite-input-time-picker id="s-second" scale="s" name="s-second" step="1" value="1:2:3">
                  </calcite-input-time-picker>
                </div>
                <div>
                  <calcite-label for="m" scale="m">Medium</calcite-label>
                  <calcite-input-time-picker id="m" scale="m" name="m" value="123"></calcite-input-time-picker>
                </div>
                <div>
                  <calcite-label for="m-second" scale="m">Medium with seconds</calcite-label>
                  <calcite-input-time-picker id="m-second" scale="m" name="m-second" step="1" value="invalidvalue">
                  </calcite-input-time-picker>
                </div>
                <div>
                  <calcite-label for="l" scale="m">Large</calcite-label>
                  <calcite-input-time-picker id="l" scale="l" name="l"></calcite-input-time-picker>
                </div>
                <div>
                  <calcite-label for="l-second" scale="m">Large with seconds</calcite-label>
                  <calcite-input-time-picker
                    id="l-second"
                    scale="l"
                    name="l-second"
                    step="1"
                  ></calcite-input-time-picker>
                </div>
              </demo-spacer>
            </div>
            <div class="demo-background-dark calcite-theme-dark">
              <demo-spacer>
                <div>
                  <calcite-label for="s-dark" scale="s">Small</calcite-label>
                  <calcite-input-time-picker scale="s" id="s-dark" name="s-dark"></calcite-input-time-picker>
                </div>
                <div>
                  <calcite-label for="s-dark-second" scale="s">Small with seconds</calcite-label>
                  <calcite-input-time-picker scale="s" id="s-dark-second" name="s-dark-second" step="1">
                  </calcite-input-time-picker>
                </div>
                <div>
                  <calcite-label for="m-dark" scale="m">Medium</calcite-label>
                  <calcite-input-time-picker scale="m" id="m-dark" name="m-dark"></calcite-input-time-picker>
                </div>
                <div>
                  <calcite-label for="m-dark-second" scale="m">Medium with seconds</calcite-label>
                  <calcite-input-time-picker scale="m" id="m-dark-second" name="m-dark-second" step="1">
                  </calcite-input-time-picker>
                </div>
                <div>
                  <calcite-label for="l-dark" scale="l">Large</calcite-label>
                  <calcite-input-time-picker scale="l" id="l-dark" name="l-dark"></calcite-input-time-picker>
                </div>
                <div>
                  <calcite-label for="l-dark-second" scale="l">Large with seconds</calcite-label>
                  <calcite-input-time-picker scale="l" id="l-dark-second" name="l-dark-second" step="1">
                  </calcite-input-time-picker>
                </div>
              </demo-spacer>
            </div>
            <calcite-button form="calcite-time-demo-form" type="submit">Submit</calcite-button>
            <button type="submit" style="display: none">Submit</button>
          </demo-spacer>
        </form>
      </demo-form>
    </demo-spacer>
    <script>
      (async () => {
        await customElements.whenDefined("calcite-input-time-picker");
        const inputTimePicker = document.querySelector("calcite-input-time-picker");
        await inputTimePicker.componentOnReady();

        const calciteInput = inputTimePicker.querySelector("calcite-input");
        const input = inputTimePicker.querySelector("input");

        document.addEventListener("calciteInputTimePickerChange", (event) => {
          console.log("calciteInputTimePickerChange", event.target.value);
        });

        document.getElementById("change-input-time-picker").addEventListener("input", (event) => {
          const date = new Date(0);
          date.setSeconds(event.target.value);

          const expectedValue = date.toISOString().substr(11, 8);
          inputTimePicker.value = expectedValue;
          if (inputTimePicker.value !== calciteInput.value) {
            console.log(
              "VALUES DON'T EQUAL!!!",
              "inputTimePicker:",
              inputTimePicker.value,
              "calciteInput:",
              calciteInput.value,
              "input:",
              input.value
            );
          }
        });

        document.getElementById("prevent-default").addEventListener("calciteInputTimePickerChange", (event) => {
          if (!event.target.value) {
            event.preventDefault();
          }
        });

        document.getElementById("setFocus").addEventListener("click", () => {
          inputTimePicker.setFocus();
        });
      })();
    </script>
  </body>
</html>
